---
title: "Cardiovascular Disease Prediction"
description: "Leveraging machine learning to predict CVD using CatBoost Classifier with an impressive performance on key metrics."
pubDate: "May 11 2023"
heroImage: "/cvd.jpeg"
---

Cardiovascular disease – CVD – is a non-communicable disease that highly contributes to world deaths annually, due to the limited availability of its relevant health programs (World Health Organization (WHO), 2021). This report studies the correlation between CVD and its risk factors to develop a model which can predict the development of CVD by using machine learning; risk factors include an individual’s blood pressure, glucose and cholesterol levels, smoking, diabetes, inactivity, family history, age, gender, and alcohol consumption. We utilized 70,000 datasets from Kaggle and analyzed data through Pearson’s correlation, Chi-squared test, and Cramer’s V test for continuous, binary, and trinary variables, respectively. Subsequently, we employed machine learning to build an application that leverages the risk factors of CVD to predict the possibility of an individual developing CVD. While the reliability of the data source may be questionable, from our study, it can be concluded that systolic blood pressure holds the greatest influence as the risk factor for developing CVD.

## Introduction

Cardiovascular disease, CVD, in short, occurs when blood is not properly supplied to the heart due to blood clot — thrombosis — or accumulated fatty substances within an artery — atherosclerosis —. As CVD is a non-communicable disease, the relevant health programs are not as readily available to the public; that is why, oftentimes its symptoms are overlooked by people, contributing heavily as a leading cause of death. According to the WHO, approximately 18 million deaths were caused by CVD, comprising 32% of global deaths. Furthermore, more than 75% of CVD deaths are from people of the middle and low-income class (World Health Organization(WHO), 2021). Hence it is necessary to study the contributing factors leading to possible CVD and allow people to detect CVD as early as possible.
High blood pressure (HBP) and high cholesterol levels narrow the blood vessels through the accumulation of plaque, doubling the chance of CVD development. Excessive alcohol consumption can trigger CVD development as well since it leads to HBP and high cholesterol levels. Additionally, smoking can block blood flow into the heart and brain, as it enforces the stickier blood to clot more frequently; triggering plaque accumulation that can possibly narrow blood vessels. Lastly, people with significant physical inactivity and obesity are more susceptible to CVD since they would also have higher blood pressure.
Literature Review
According to the literature, the risk of developing cardiovascular disease was predicted using machine learning techniques, like Multi-layer Perception, and K-nearest neighbor (Pal, M., Parija, S., Panda, G., Dhama, K. and Mohapatra, R.K, (2022). The data incorporated 13 personal attributes, such as age, gender, height, etc, and the result demonstrated a high prediction accuracy level of over 82%. However, this model has a significantly small sample size of 303 samples, which is remarkably small to be reliable. This highlights the necessity of a new model that is both highly accurate and with a large sample size to reliably predict the likelihood of developing cardiovascular disease.

## Materials and methods
We obtained a CVD dataset from Kaggle, originally containing 70,000 samples. The data is refined by eliminating outliers using a Python function, which computes the interquartile range (IQR) for each numeric column, and omits values falling outside Q1 - 1.5IQR or above Q3 + 1.5IQR. This process resulted in a final dataset of 62,502 samples, each with 11 personal attributes: age (in days), gender (1-male; 2-female), height (in cm), weight (in kg), systolic and diastolic blood pressures, cholesterol, glucose levels, smoking status, alcohol consumption, and physical activity level. The binary output, cardiovascular disease, indicates whether a patient has the disease.
We can categorize the attributes into 3 groups; continuous, binary, and trinary variables (Figure 2). Different statistical tests can be used for each sub-group to observe if there are any associations between these variables and cardiovascular disease. Figure 3 provides the definitions of digits in binary and trinary variables. For instance, in the context of smoking, value 0 represents non-smoker while 1 indicates smoker. Similarly, values levels 1, 2, and 3 symbolize normal, above normal, and well above normal levels of glucose, respectively.
As the data size is extremely large, computer programming, specifically Pandas, was used to perform statistical analysis. Firstly, for continuous variables, the mean value and standard deviations were calculated. Then, Pearson's correlation test was used for statistical analysis. +1, 0, and +1 in Pearson’s correlation coefficient represent perfect positive and zero and perfect negative correlation, respectively. Secondly, for binary variables, a 2x2 contingency was formulated as shown in Figure 3, and a Chi-square test can be used. For an example of smoking, the null hypothesis will be “There is no statistically significant association between smoking and cardiovascular disease”. Finally, for trinary variables, a 3x2 contingency table can be formulated (Figure 5). Cramer’s V test was used as a statistical test; it is similar to the Chi-square test, except it is unidirectional. It does not tell us if the correlation is positive or negative but only shows the strength of the association (Cramer’s V, 2020).

## Results

To begin with, Figure 6 described the balanced number of those with CVD and without CVD, representing unbiased data. In the case of continuous variables, the frequency of each class, the mean, standard deviations, and Pearson’s correlation coefficient of each variable were computed (Figure 7). The highest correlation coefficient with cardiovascular disease was observed in systolic blood pressure (0.432), followed by diastolic blood pressure (0.336). On the other hand, the least correlation coefficient was observed in height (-0.0276). The observed results are consistent with our prior expectations, as patients with cardiovascular disease would have conditions with their heart, leading to extreme values of blood pressure.
For binary variables, the frequency of each class was first shown, then the p-value computed from the Chi-square test is described in Figure 8. Using a confidence level of 0.05, the result shows that there was an association between smoking (p=3.22E-08), alcohol consumption (p=0.0022), and physical activity (p=4.03E-21) with cardiovascular disease, while no association between gender (p=0.232) and cardiovascular disease was observed.
Similarly for trinary variables, the frequency of each class was also calculated, and p-values from Cramer’s V test were computed as described in Figure 9. Since Cramer’s V test only shows the strength of association, the value lies between 0 (zero correlation) and +1 (perfect correlation). The result shows that Cholesterol level shows a higher correlation (0.218) than glucose (0.0893) with cardiovascular disease.

## Discussion on Statistical Analysis

The results from our statistical analyses strongly suggest that factors such as systolic and diastolic blood pressure, smoking, alcohol consumption, physical activity, cholesterol level, and glucose level have significant associations with the risk of cardiovascular disease, which align with the existing literature. Our study benefits from a much larger sample size, enhancing the reliability of our findings. The unexpected dissociation between gender and cardiovascular disease (CVD) is noteworthy, given that gender has been established as a risk factor for CVD in the literature (Bots, Peters, and Woodward, 2017). It is plausible that the observed dissociation may be attributed to variation in sub-groups such as racial group, or ethnicity.
Furthermore, our model exhibits some limitations due to constrained availability of our model due to the limited availability of the data. Patient’s past medical history such as past heart disease, which can highly impact the risk of CVD development, has not been considered in our data set. Additionally, the information on smoking is also limited. Current non-smokers, who were heavy smokers in the past, are still considered as non-smokers, which is misleading. These limitations demonstrate the unavoidable shortcomings of our model, emphasizing the need for future improvements utilizing a more refined data set.

## Model Selection, Evaluation, and Feature Importance Analysis

Our primary objective was to develop an effective prediction model using various machine learning algorithms. Initially, ten different machine learning algorithms were evaluated using 10-fold cross-validation. These included Logistic Regression, Gaussian Naive Bayes, LGBM Classifier, SVC, Decision Tree Classifier, Random Forest Classifier, XGB Classifier, Gradient Boost Classifier, CatBoost Classifier, and Stacked Classifier. The comparison of these models is illustrated in Figure 10.
While the Gradient Boost Classifier demonstrated superior performance, the CatBoost Classifier was ultimately selected. The reason for this choice was its unique ability to balance exceptional performance with high interpretability, making it an ideal choice for our study. One of the key features of the CatBoost Classifier is its handling of categorical variables, which are inherently present in our dataset. In the model development phase, a feature importance analysis was conducted. This analysis allowed us to assess the relative importance of each feature in the model's decision-making process. As presented in Figure 11, variables such as systolic blood pressure, diastolic blood pressure, and cholesterol level emerged as the most influential features in predicting the likelihood of cardiovascular disease.

## Hyperparameter Optimization and Model Training

To ensure the optimal performance of our CatBoost Classifier, we undertook hyperparameter optimization using a Random Grid Search. The parameters considered included depth, l2_leaf_reg, iterations, and learning_rate. As illustrated in Figure 12, the optimal combination of parameters was found to be: {'depth': 4, 'l2_leaf_reg': 9, 'iterations': 6000, 'learning_rate': 0.05}.
With these optimal parameters, we proceeded to train the final model. The progress of the training, depicted in Figure 13, showed a consistent improvement in the model's performance metrics over the iterations. The final model yielded an accuracy of 0.7315, precision of 0.7432, recall of 0.6835, and an F1-score of 0.7121, demonstrating the effectiveness of our approach and the potential utility of this model in a clinical setting. Consequently, the validity and predictive power of our model establish it as a formidable tool for preliminary screening in the fight against cardiovascular disease.

## References
Bots, S.H., Peters, S.A.E. and Woodward, M. (2017). Sex differences in coronary heart disease and stroke mortality: a global assessment of the effect of ageing between 1980 and 2010. BMJ Global Health, [online] 2(2). doi:https://doi.org/10.1136/bmjgh-2017-000298.
NHS (2022). Cardiovascular disease. [online] NHS. Available at: https://www.nhs.uk/conditions/cardiovascular-disease/ [Accessed 24 Apr. 2023].
Pal, M., Parija, S., Panda, G., Dhama, K. and Mohapatra, R.K. (2022). Risk prediction of cardiovascular disease using machine learning classifiers. Open Medicine, 17(1), pp.1100–1113. doi:https://doi.org/10.1515/med-2022-0508.
StatsTest.com. (n.d.). Cramer’s V. [online] Available at: https://www.statstest.com/cramers-v-2 [Accessed 11 May 2023].
World Health Organization (2021). Cardiovascular diseases. [online] World Health Organization. Available at:
https://www.who.int/news-room/fact-sheets/detail/cardiovascular-diseases-(cvds)
[Accessed 25 Apr. 2023].
www.kaggle.com. (2019). Cardiovascular Disease dataset. [online] Available at:
https://www.kaggle.com/datasets/sulianova/cardiovascular-disease-dataset?select=car dio_train.csv. [Accessed 10 Apr. 2023].